// IUS 0.1. Created by ivaniesta14.

package ivaniesta14.ius

import java.math.BigDecimal
import java.math.BigInteger
import java.util.LinkedHashSet
import java.util.LinkedList
import java.util.Map
import org.apache.commons.math3.special.Gamma
import org.apache.commons.math3.stat.StatUtils
import org.apache.commons.math3.util.ArithmeticUtils
import org.apache.commons.math3.util.CombinatoricsUtils
import org.apache.commons.math3.util.MathUtils

import static extension org.apache.commons.math3.util.FastMath.*

class IUS {
	static var stack = new LinkedList<String>

	static val parseStack = new LinkedList<String>

	public static val Map<String, =>String> nilads = newHashMap
	public static val Map<String, (String)=>String> monads = newHashMap
	public static val Map<String, (String, String)=>String> dyads = newHashMap

	static def Pair<String, Runnable> asNilad(String id, =>String arg) {
		nilads.put(id, arg)
		id -> [arg.apply.put]
	}
	static def <T> Pair<String, Runnable> asNiladn(String id, =>T arg) { id.asNilad[arg.apply.s] }
	static def Pair<String, Runnable> asMonad(String id, (String)=>String arg) {
		monads.put(id, arg)
		id -> [arg.apply(pip).put]
	}
	static def <T> Pair<String, Runnable> asMonadn(String id, (String)=>T arg) { id.asMonad[arg.apply(it).s] }
	static def Pair<String, Runnable> asDyad(String id, (String, String)=>String arg) {
		dyads.put(id, arg)
		id -> [arg.apply(pip, pip).put]
	}
	static def <T> Pair<String, Runnable> asDyadn(String id, (String, String)=>T arg) {
		id.asDyad[arg.apply($0, $1).s]
	}

	@SuppressWarnings("all" /*missing @Override. Xtend issue; some unchecked casts*/ )
	public static val Map<String, Runnable> functions = #{
		'0'.asNiladn[0], // Number 0
		'1'.asNiladn[1],
		'2'.asNiladn[2],
		'3'.asNiladn[3],
		'4'.asNiladn[4],
		'5'.asNiladn[5],
		'6'.asNiladn[6],
		'7'.asNiladn[7],
		'8'.asNiladn[8],
		'9'.asNiladn[9], // Number 9
		'‚Å∞'.asMonad[it + '0'], // Superscript 0
		'¬π'.asMonad[it + '1'],
		'¬≤'.asMonad[it + '2'],
		'¬≥'.asMonad[it + '3'],
		'‚Å¥'.asMonad[it + '4'],
		'‚Åµ'.asMonad[it + '5'],
		'‚Å∂'.asMonad[it + '6'],
		'‚Å∑'.asMonad[it + '7'],
		'‚Å∏'.asMonad[it + '8'],
		'‚Åπ'.asMonad[it + '9'], // Superscript 9,
		'+'.asDyadn[($0.bi + $1.bi)], // Plus
		'-'.asDyadn[($0.bi - $1.bi)], // Minus
		'√ó'.asDyadn[($0.bi * $1.bi)], // Times
		'√∑'.asDyadn[($0.bi / $1.bi)], // Obelus
		'%'.asDyadn[($0.bi.remainder($1.bi))], // Percent
		'Îë™'.asNilad[stack.peek], // Hangul Syllable dup
		'‚å´' -> [stack.pop] as Runnable, // Erase to the left
		'Îö∂' -> [stack.peek.put.put] as Runnable, // HS ddup
		'ÏáÇ' -> [pip => [pip => [$0|put $0.put]]] as Runnable, // HS swap
		'‚ô∫' -> [pip => [pip => [$0|pip => [$1|put $0.put $1.put]]]] as Runnable, // U+267A
		'‚Ä≤'.asNilad[parseStack.pip], // Prime
		'‚Ä≥'.asNilad[parseStack.pip + parseStack.pip], // Double Prime
		'‚Ä¥'.asNilad[parseStack.pip + parseStack.pip + parseStack.pip], // Triple prime
		'‚Åó'.asNilad[parseStack.pip + parseStack.pip + parseStack.pip + parseStack.pip], // Quad Prime
		'"'.asNilad [
			val it = new StringBuilder
			var c = ""
			while((c = parseStack.pip) != '' && c != '"')
				append(c)
			s
		], // Double Quote
		"'".asNilad[''], // Single quote
		'‚ªë'.asNiladn[stack.size], // CJK Radical Long One
		'‚ªí'.asMonadn[length], // CJK Radical Long Two
		'√≠'.asMonadn [
			try {
				new BigInteger(it)
				1
			} catch(NumberFormatException _)
				0
		], // Small I with Acute
		'√ç'.asMonadn [
			try {
				new BigInteger(it)
				0
			} catch(NumberFormatException _)
				1
		], // Small I with Acute
		'≈ï'.asMonadn [
			try {
				new BigDecimal(it)
				1
			} catch(NumberFormatException _)
				0
		], // Small I with Acute
		'≈î'.asMonadn [
			try {
				new BigDecimal(it)
				0
			} catch(NumberFormatException _)
				1
		], // Small I with Acute
		'√©'.asMonad[empty.is], // Small E with Acute
		'√â'.asMonad[empty.nis], // Capital E with Acute
		'‚àñ'.asDyad[(new LinkedHashSet($0.toCharArray) => [removeAll($1.toCharArray)]).join], // Set Minus
		'Î†¢'.asDyad[$0.repeat($1.in)], // HS Rep
		'‚ªì'.asDyad [
			val it = new StringBuilder
			for (i : 0 ..< $1.length)
				append($0.charAt(i % $0.length))
			s
		], // CJK Radical C-Simplified Long
		'Ïö¥'.asMonad[new LinkedHashSet(toCharArray).join], // HS Un
		'‚åã'.asDyadn[ArithmeticUtils.lcm($0.lin, $1.lin)], // Right Floor
		'‚åâ'.asDyadn[$0.bii.gcd($1.bii)], // Right Ceiling
		'!'.asMonadn[new BigDecimal(CombinatoricsUtils.factorialDouble(in)).toBigInteger], // Exclamation
		'‚àß'.asDyadn[$0.bii.and($1.bii)], // And
		'‚à®'.asDyadn[$0.bii.or($1.bii)], // Or
		'‚äª'.asDyadn[$0.bii.xor($1.bii)], // Xor
		'‚äº'.asDyadn[$0.bii.and($1.bii).not], // Nand
		'‚äΩ'.asDyadn[$0.bii.or($1.bii).not], // Nor
		'<'.asDyad[($0.bi < $1.bi).is], // Lt
		'>'.asDyad[($0.bi > $1.bi).is], // Gt
		'='.asDyad[($0.bi == $1.bi).is], // Eq
		'‚â§'.asDyad[($0.bi <= $1.bi).is], // Leq
		'‚â•'.asDyad[($0.bi >= $1.bi).is], // Geq
		'‚â†'.asDyad[($0.bi != $1.bi).is], // Neq
		'Ïïñ'.asMonadn[bi.abs], // HS Abs
		'Ï¥õ'.asMonadn[di.cos], // HS Cos
		'Ïã†'.asMonadn[di.sin], // HS Sin
		'ÌÉÑ'.asMonadn[di.tan], // HS Tan
		'Ï¥ú'.asMonadn[di.cosh], // HS Coss
		'Ïã¢'.asMonadn[di.sinh], // HS Sinh
		'ÌÉÜ'.asMonadn[di.tanh], // HS Tanh
		'Ïµú'.asMonadn[di.acos], // HS Coe
		'Ïî¨'.asMonadn[di.asin], // HS Sinn
		'ÌÉÖ'.asMonadn[di.atan], // HS Tanj
		'Ïµù'.asMonadn[di.acosh], // HS Coeg
		'Ïã±'.asMonadn[di.asinh], // HS Sing
		'ÌÉï'.asMonadn[di.atanh], // HS Tang
		'üóö'.asMonadn[bi + 1bd], // Increase Font Size
		'üóõ'.asMonadn[bi - 1bd], // Decrease Font Size
		'‚åä'.asMonadn[bi.toBigInteger], // Left Floor
		'‚åà'.asMonadn[di.ceil], // Left Ceiling
		'üóï'.asDyadn[$0.bi.min($1.bi)], // Minimize
		'üóñ'.asDyadn[$0.bi.max($1.bi)], // Maximize
		'Î†ô'.asMonadn[new StringBuilder(it)], // HS Reb
		'„èí'.asMonadn[di.log10], // Square Log
		'„èë'.asMonadn[di.log], // Square Ln
		'‚è®'.asMonadn[10.pow(di)], // Decimal Exponent Symbol
		'‚ÑØ'.asMonadn[E.pow(di)], // Script Small E
		'‚àö'.asMonadn[di.sqrt], // Square Root
		'‚àõ'.asMonadn[di.cbrt], // Cube Root
		'‚àú'.asMonadn[di.pow(0.25d)], // Fourth Root
		'‚®∞' -> [pip => [(0 ..< pipInt).forEach[_|put]]] as Runnable, // Times, Dot Above
		'ÌÉõ'.asDyadn[$0.di.atan2($1.di)], // HS Tah
		'‚Üë'.asMonad[toUpperCase], // Upwards Arrow
		'‚Üì'.asMonad[toLowerCase], // Downwards Arrow
		'‚áë'.asMonad[toFirstUpper], // Upwards Double Arrow
		'‚áì'.asMonad[toFirstLower], // Downwards Double Arrow
		'‚òõ'.asDyadn[$0.charAt($1.in)], // Black Right Pointing Index
		'Œ±'.asNilad['abcdefghijklmnopqrstuvwxyz'], // Greek Alpha
		'Œë'.asNilad['ABCDEFGHIJKLMNOPQRSTUVWXYZ'], // Greek Capital Alpha
		'∆®'.asMonadn[bi - 2bd], // Tone 2
		'∆ß'.asMonadn[bi + 2bd], // Capital Tone 2
		'‡º´'.asMonadn[bi / 2bd], // Tibetan Half 2
		'‡º¨'.asMonadn[bi / 3bd],
		'‡º≠'.asMonadn[bi / 4bd],
		'‡ºÆ'.asMonadn[bi / 5bd],
		'‡ºØ'.asMonadn[bi / 6bd],
		'‡º∞'.asMonadn[bi / 7bd],
		'‡º±'.asMonadn[bi / 8bd],
		'‡º≤'.asMonadn[bi / 9bd], // Tibetan Half 9
		'‡º≥'.asMonadn[bi / 10bd], // Tibetan Half 0
		'‚Ñº'.asNiladn[PI], // Double-struck pi
		'‚Öá'.asNiladn[E], // Double-struck e
		'ùúë'.asNiladn[((1d + 5.sqrt) / 2)], // Mathematical Italic Small Phi
		'‚Üä'.asMonadn[2.log(di)], // Turned Digit Two
		'∆ª'.asMonadn[2.pow(di)], // Latin Letter Two with Stroke
		'ùêÇ'.asDyadn[CombinatoricsUtils.binomialCoefficientDouble($0.in, $1.in)], // Mathematical Bold Capital C
		'Œì'.asMonadn[Gamma.gamma(di)], // Greek Gamma
		'œú'.asMonadn[Gamma.digamma(di)], // Greek Digamma
		'ùúè'.asNiladn[MathUtils.TWO_PI], // Mathematical Italic Small Tau
		'Îã∂'.asDyadn[($0.bi - $1.bi).abs], // HS Dabs
		'‚â∫' -> [
			new StringBuilder => [
				for (c : pip.toCharArray)
					append(c).put
			]
		] as Runnable, // Precedes
		'·Ç™'.asMonadn[charAt(length - 1)], // Georgian Capital Las
		'·Éö'.asMonadn[charAt(0)], // Georgian Las
		'¬∫'.asMonad[toCharArray.sortWith[$0 <=> $1].join], // Masculine Ord. Ind
		'¬™'.asMonad[toCharArray.sortWith[$1 <=> $0].join], // Feminine Ord. Ind
		'‰∑ñ' -> [pip.split('\\s').forEach[put]] as Runnable, // Hexagram: Splitting apart
		'‚àí'.asMonadn[bi.negate], // Minus Sign
		'‚Üí' -> [(0 ..< pipInt).forEach[put]] as Runnable, // Rightwards Arrow
		'‚Ü£' -> [(0 .. pipInt).forEach[put]] as Runnable, // Rightwards Arrow with Tail
		'‚Ü¶' -> [(1 ..< pipInt).forEach[put]] as Runnable, // Rightwards Arrow from Bar
		'‚Ü™' -> [(1 .. pipInt).forEach[put]] as Runnable, // Rightwards Arrow with Hook
		'‚èª'.asDyadn[ArithmeticUtils.pow($0.bii, $1.bii)], // Power Symbol
		'‚Ö©'.asNiladn[10], // Uppercase Roman Numerals
		'‚Ö™'.asNiladn[11],
		'‚Ö´'.asNiladn[12],
		'‚Ö¨'.asNiladn[50],
		'‚Ö≠'.asNiladn[100],
		'‚ÖÆ'.asNiladn[500],
		'‚ÖØ'.asNiladn[1000],
		'‚ÜÅ'.asNiladn[5000],
		'‚ÜÇ'.asNiladn[10000],
		'‚Üá'.asNiladn[50000],
		'‚Üà'.asNiladn[100000],
		'‚Ö≥'.asNiladn[16], // Lowercase Roman Numerals
		'‚Ö¥'.asNiladn[32],
		'‚Öµ'.asNiladn[64],
		'‚Ö∂'.asNiladn[128],
		'‚Ö∑'.asNiladn[256],
		'‚Ö∏'.asNiladn[512],
		'‚Öπ'.asNiladn[1024],
		'‚Ö∫'.asNiladn[2048],
		'‚Öª'.asNiladn[4096],
		'‚Öº'.asNiladn[1125899906842624l],
		'‚ÖΩ'.asNiladn[1267650600228229401496703205376bi],
		'‚Öæ'.asNiladn[(2bi ** 500)],
		'‚Öø'.asNiladn[(2bi ** 1000)],
		'Ôºì'.asNiladn[13], // Fullwidth characters
		'Ôºî'.asNiladn[14],
		'Ôºï'.asNiladn[15],
		'Ôºñ'.asNiladn[16],
		'Ôºó'.asNiladn[17],
		'Ôºò'.asNiladn[18],
		'Ôºô'.asNiladn[19],
		'Ôº°'.asNiladn[20],
		'Ôº¢'.asNiladn[21],
		'Ôº£'.asNiladn[22],
		'Ôº§'.asNiladn[23],
		'Ôº•'.asNiladn[24],
		'Ôº¶'.asNiladn[25],
		'Ôºß'.asNiladn[26],
		'Ôº®'.asNiladn[27],
		'Ôº©'.asNiladn[28],
		'Ôº™'.asNiladn[29],
		'Ôº´'.asNiladn[30],
		'Ôº¨'.asNiladn[31],
		'Ôº≠'.asNiladn[32],
		'ÔºÆ'.asNiladn[33],
		'ÔºØ'.asNiladn[34],
		'Ôº∞'.asNiladn[35],
		'Ôº±'.asNiladn[36],
		'Ôº≤'.asNiladn[40],
		'Ôº≥'.asNiladn[50],
		'Ôº¥'.asNiladn[60],
		'Ôºµ'.asNiladn[70],
		'Ôº∂'.asNiladn[80],
		'Ôº∑'.asNiladn[90],
		'Ôº∏'.asNiladn[200],
		'Ôºπ'.asNiladn[300],
		'Ôº∫'.asNiladn[400],
		'Ôºê'.asNiladn[600],
		'Ôºë'.asNiladn[700],
		'Ôºí'.asNiladn[800],
		'ÔΩÅ'.asNiladn[900],
		'ÔΩÇ'.asNiladn[1100],
		'ÔΩÉ'.asNiladn[1200],
		'ÔΩÑ'.asNiladn[1300],
		'ÔΩÖ'.asNiladn[1400],
		'ÔΩÜ'.asNiladn[95],
		'ÔΩá'.asNiladn[63],
		'ÔΩà'.asNiladn[127],
		'ÔΩâ'.asNiladn[255],
		'ÔΩä'.asNiladn[511],
		'ÔΩã'.asNiladn[1023],
		'ÔΩå'.asNiladn[2047],
		'ÔΩç'.asNiladn[4095],
		'ÔΩé'.asNiladn[8191],
		'ÔΩè'.asNiladn[(2bi ** 14 - 1bi)],
		'ÔΩê'.asNiladn[(2bi ** 15 - 1bi)],
		'ÔΩë'.asNiladn[(2bi ** 16 - 1bi)],
		'ÔΩí'.asNiladn[(2bi ** 17 - 1bi)],
		'ÔΩì'.asNiladn[(2bi ** 18 - 1bi)],
		'ÔΩî'.asNiladn[(2bi ** 19 - 1bi)],
		'ÔΩï'.asNiladn[(2bi ** 20 - 1bi)],
		'ÔΩñ'.asNiladn[(2bi ** 20)],
		'ÔΩó'.asNiladn[(2bi ** 30)],
		'ÔΩò'.asNiladn[(2bi ** 40)],
		'ÔΩô'.asNiladn[(2bi ** 50)],
		'ÔΩö'.asNiladn[(2bi ** 60)],
		'¬Ω'.asNiladn[0.5bd], // Fractions
		'‚Öì'.asNiladn[(1bd / 3bd)],
		'¬º'.asNiladn[0.25bd],
		'‚Öï'.asNiladn[0.2bd],
		'‚Öô'.asNiladn[(1bd / 6bd)],
		'‚Öê'.asNiladn[(1bd / 7bd)],
		'‚Öõ'.asNiladn[0.125bd],
		'‚Öë'.asNiladn[(1bd / 9bd)],
		'‚Öí'.asNiladn[0.1bd],
		'‚Öî'.asNiladn[(2bd / 3bd)],
		'‚Öñ'.asNiladn[0.4bd],
		'¬æ'.asNiladn[0.75bd],
		'‚Öó'.asNiladn[0.6bd],
		'‚Öò'.asNiladn[0.8bd],
		'‚Öú'.asNiladn[0.375bd],
		'‚Öù'.asNiladn[0.625bd],
		'‚Öû'.asNiladn[0.875bd],
		'‚àë' -> [stack.map[new BigDecimal(it)].reduce[$0 + $1].put] as Runnable, // N-ary summation sign
		'‚ì™'.asMonadn[(bi == 0bd).is], // Circled numerals
		'‚ë†'.asMonadn[(bi == 1bd).is],
		'‚ë°'.asMonadn[(bi == 2bd).is],
		'‚ë¢'.asMonadn[(bi == 3bd).is],
		'‚ë£'.asMonadn[(bi == 4bd).is],
		'‚ë§'.asMonadn[(bi == 5bd).is],
		'‚ë•'.asMonadn[(bi == 6bd).is],
		'‚ë¶'.asMonadn[(bi == 7bd).is],
		'‚ëß'.asMonadn[(bi == 8bd).is],
		'‚ë®'.asMonadn[(bi == 9bd).is],
		'‚ë©'.asMonadn[(bi == 0bd).is],
		'‚ìø'.asMonadn[(bi == 0bd).nis], // Circled numerals (black)
		'‚ù∂'.asMonadn[(bi == 1bd).nis],
		'‚ù∑'.asMonadn[(bi == 2bd).nis],
		'‚ù∏'.asMonadn[(bi == 3bd).nis],
		'‚ùπ'.asMonadn[(bi == 4bd).nis],
		'‚ù∫'.asMonadn[(bi == 5bd).nis],
		'‚ùª'.asMonadn[(bi == 6bd).nis],
		'‚ùº'.asMonadn[(bi == 7bd).nis],
		'‚ùΩ'.asMonadn[(bi == 8bd).nis],
		'‚ùæ'.asMonadn[(bi == 9bd).nis],
		'‚ùø'.asMonadn[(bi == 0bd).nis],
		'‚üï'.asDyad[$0 + $1], // Left outer join
		'‚üñ' -> [(pip + pip + pip).put] as Runnable, // Right outer join
		'‚üó' -> [stack.reduce[$0 + $1].put] as Runnable, // Full outer join
		'‚ßæ' -> [stack.map[new BigDecimal(it)].max[$0 <=> $1].put] as Runnable, // Tiny
		'‚ßø' -> [stack.map[new BigDecimal(it)].min[$0 <=> $1].put] as Runnable, // Miny
		'·æÄ'.asMonad[matches('[a-zA-Z]*').is], // Alpha with Psili and Ypogegrammeni
		'·æà'.asMonad[matches('[a-zA-Z]*').nis], // Alpha with Psili and Ypogegrammeni (Capital)
		'·æÅ'.asMonad[matches('[a-z]*').is], // Alpha with Dasia and Ypogegrammeni
		'·æâ'.asMonad[matches('[a-z]*').nis], // Alpha with Dasia and Ypogegrammeni (Capital)
		'·æÇ'.asMonad[matches('[A-Z]*').is], // Alpha with Psili, Varia and Ypogegrammeni
		'·æä'.asMonad[matches('[A-Z]*').nis], // Alpha with Psili, Varia and Ypogegrammeni (Capital)
		'·∫ã' -> [StatUtils.mean(stack.map[new BigDecimal(it).doubleValue]).put] as Runnable, // X with dot above
		'‚Ä∞' -> [bip.divideAndRemainder(bip).forEach[put]] as Runnable, // Permille
		// '‚Ü¢' -> [pip.charAt(0).put] as Runnable, // Left arrow with tail
		'‚¨π'.asMonad[substring(1)], // Left arrow with tail and stroke
		'‚¨∫' -> [pip => [charAt(0).put substring(1).put]] as Runnable, // Ditto, two strokes
		'‚ô≥'.asMonad[substring(1) + substring(0, 1)], // Recycling symbol, type-1 plastic
		'‚ô¥'.asMonad[substring(2) + substring(0, 2)], // Recycling symbol, type-2 plastic
		'‚ôµ'.asMonad[substring(3) + substring(0, 3)], // Recycling symbol, type-3 plastic
		'‚ô∂'.asMonad[substring(4) + substring(0, 4)], // Recycling symbol, type-4 plastic
		'‚ô∑'.asMonad[substring(5) + substring(0, 5)], // Recycling symbol, type-5 plastic
		'‚ô∏'.asMonad[substring(6) + substring(0, 6)], // Recycling symbol, type-6 plastic
		'‚ôπ'.asMonad[substring(7) + substring(0, 7)], // Recycling symbol, type-7 plastic
		'‚Åº' -> [stack.filter[stack.peek == it].empty.pit] as Runnable, // Superscript equals
		'‚Çå' -> [stack.filter[stack.peek == it].empty.nit] as Runnable, // Subscript equals
		'‚àè' -> [stack.map[new BigDecimal(it)].reduce[$0 * $1].put] as Runnable, // N-ary product
		'‰∑™' -> [pip.toCharArray.forEach[put]] as Runnable, // Hexagram: Breakthrough
		'‚Ñπ'.asDyad[$0.matches($1).is], // Information sign
		'Î†ö' -> [
			stack => [
				val $0 = stack.map[new StringBuilder(it).reverse.toString].toArray(<String>newArrayOfSize(0))
				clear
				addAll($0)
			]
		] as Runnable, // HS Rebs
		'¬±'.asMonadn[bi.signum], // Plus-Minus
		'ﬂπ' -> [bip.max(bip).min(bip).put] as Runnable, // Nko Exclamation Mark
		'‚òö' -> [
			pip => [val idx = pipInt put(substring(0, idx) + pip + substring(idx + 1))]
		] as Runnable, // Left idx
		'S' -> [pip => [dyads.get(pip).apply(it, monads.get(pip).apply(it)).put]] as Runnable,
		's' ->
			[pip => [dyads.get(parseStack.pip).apply(it, monads.get(parseStack.pip).apply(it)).put]] as Runnable,
		'' -> [] as Runnable
	}

	@SuppressWarnings('unchecked' /*array->iterable */ )
	def static void main(String[] args) {
		args => [head.addToParse tail.forEach[put]]
		parse
		stack.forEach[println(it)]
	}

	def static addToParse(String arg) {
		for (int i : 0 ..< arg.length)
			parseStack.add(arg.charAt(i) + "")
	}

	static def parse() {
		while(!parseStack.isEmpty)
			functions.get(parseStack.pop)?.run
	}
	/* CHARACTERS USED: currently between 256 and 512, 9/8 bytes per char
	 * 0123456789: (Number literals)
	 * ‚Å∞¬π¬≤¬≥‚Å¥‚Åµ‚Å∂‚Å∑‚Å∏‚Åπ	: (Append number)
	 * +-*%/‚àí‚Ä∞¬±	: (Basic mathematical operations)
	 * Îë™‚å´Îö∂ÏáÇ‚ô∫	: (Basic stack manipulations)
	 * ‚Ä≤‚Ä≥‚Ä¥‚Åó"'	: (Basic String literals)
	 * √≠√ç≈ï≈î√©√â	: (Basic type checks)
	 * ‚ªë‚ªí		: (Stack and head sizes)
	 * ‚àñÎ†¢‚ªìÏö¥		: (String Operations I)
	 * ‚åã‚åâ!Í∞í		: (LCM, GCD, Factorial, Abs)
	 * ‚àß‚à®‚äª<>=‚â§‚â•‚â†	: (Logical operations)
	 * Ï¥õÏã†ÌÉÑÏ¥úÏã¢ÌÉÜ	: (Trigonometry)
	 * ÏµúÏî¨ÌÉÖÏµùÏã±ÌÉï	: (Inverse trigonometry)
	 * ‚áíüóöüóõ‚é£üóïüóñﬂπ	: (Inc, Dec, Floor, Ceil, Min, Max, Clam)
	 * Î†ôÎ†ö		: (Reverse)
	 * „èí„èë‚è®‚ÑØ‚àö‚àõ‚àúÌÉõ	: (General Math I)
	 * ‚®∞‚Üë‚Üì‚áë‚áì‚òõ‚òö	: (String Operations II)
	 * Œ±Œë		: (Constants I: Alphabet)
	 * ∆®∆ß‡º´‡º¨‡º≠‡ºÆ‡ºØÍ±ä	: (Shorthands I: Math)
	 * ‚Ñº‚Öáùúëùúè		: (Constants II: Math)
	 * ‚áí‚Üä∆ª			: (Binary log and exp)
	 * ‚áíùêÇŒìœú		: (Combinatorics)
	 * ‚â∫·Ç™·Éö¬∫¬™‚áí‰∑ñ		: (String Operations III)
	 * ‚Üí‚Ü£‚Ü¶‚Ü™		: (Ranges)
	 * ‰∑°‚Öü√®√à		: (General Math II)
	 * ‚Ö©‚Ö™‚Ö´‚Ö¨‚Ö≠‚ÖÆ‚ÖØ‚ÜÅ‚ÜÇ	: (Constants III: Numbers I)
	 * ‚Üá‚Üà‚Ö≥‚Ö¥‚Öµ‚Ö∂‚Ö∑‚Ö∏‚Öπ	: (Constants IV: Numbers II)
	 * ‚Ö∫‚Öª‚Öº‚ÖΩ‚Öæ‚ÖøÔºìÔºîÔºïÔºñÔºó	: (Constants V: Numbers III)
	 * ÔºòÔºôÔº°Ôº¢Ôº£Ôº§Ôº•Ôº¶	: (Constants VI: Numbers IV)
	 * ÔºßÔº®Ôº©Ôº™Ôº´Ôº¨Ôº≠ÔºÆÔºØÔº∞	: (Constants VII: Numbers V)
	 * Ôº±Ôº≤Ôº≥Ôº¥ÔºµÔº∂Ôº∑Ôº∏ÔºπÔº∫	: (Constants VIII: Numbers VI)
	 * ÔºêÔºëÔºíÔΩÅÔΩÇÔΩÉÔΩÑÔΩÖÔΩÜÔΩáÔΩà	: (Constants IX: Numbers VII)
	 * ÔΩâÔΩäÔΩãÔΩåÔΩçÔΩéÔΩèÔΩêÔΩëÔΩíÔΩìÔΩîÔΩïÔΩñ	: (Constants X: Numbers VIII)
	 * ÔΩóÔΩòÔΩôÔΩö¬Ω‚Öì¬º‚Öï‚Öô‚Öê‚Öõ	: (Constants XI: Numbers IX)
	 * ‚Öë‚Öí‚Öî‚Öñ¬æ‚Öó‚Öò‚Öú	: (Constants XII: Numbers X)
	 * ‚Öù‚Öû		: (Constants XIII: Numbers XI)
	 * ‚áí‚àë‚ßæ‚ßø·∫ã‚Åº‚Çå‚àè	: (Iterations and reductions)
	 * ‚ì™‚ë†‚ë°‚ë¢‚ë£‚ë§‚ë•‚ë¶‚ëß	: (Equality Checks I)
	 * ‚ë®‚ë©‚ìø‚ù∂‚ù∑‚ù∏‚ùπ‚ù∫‚ùª	: (Equality Checks II)
	 * ‚ùº‚ùΩ‚ùæ‚ùø		: (Equality Checks III)
	 * ‚üï‚üñ‚üó		: (Joins)
	 * ·æÄ·æà·æÅ·æâ·æÇ·æä‚Ñπ	: (Regex Checks)
	 * ‚Ü¢‚¨π‚¨∫‰∑™		: (Head Splitting)
	 * ‚ô≥‚ô¥‚ôµ‚ô∂‚ô∑‚ô∏‚ôπ	: (Head Rotation)
	 * Ss		: S combinator (Sxyz->x(y,z(x)))
	 */
	/**Pop if present, else return an empty string */
	@Pure static def pip(LinkedList<? extends String> arg) {
		if(arg.isEmpty) "" else arg.pop
	}

	static def <T> put(T s) {
		stack.push(s.s)
		s
	}

	@Pure private static def bi(String s) { new BigDecimal(s) }
	@Pure private static def bii(String s) { new BigInteger(s) }
	@Pure private static def di(String s) { s.bi.doubleValue }
	@Pure private static def in(String s) { s.bi.intValue }
	@Pure private static def lin(String s) { s.bi.longValue }

	@Pure private static def pip() { stack.pip }

	@Pure private static def bip() { pip.bi }

	@Pure private static def pipInt() { bip.intValue }

	@Pure private static def <T> s(T t) { t.toString }

	private static def pit(Boolean it) {
		(if(it) '1' else '0').put
	}

	private static def nit(Boolean it) {
		(if(it) '0' else '1').put
	}

	@Pure private static def is(Boolean it) {
		it ? '1' : '0'
	}
	@Pure private static def nis(Boolean it) {
		it ? '0' : '1'
	}
}
